
## 26 October 2024
Flex diagramming -- Generate css files for diagram methods. Have separate animation file.   

### Rationale
Tidy up before I implement new even-odd fill colours (see change log 25-Oct-2024).

### Summary
The idea is that css files should be generated from the shape styles and text styles that are in the diagram model.

### Analysis
Situation is 
1. 'xslt/flex/ERmodel2flex' generates flex diagram xml
    with default having shape_style 'outline' 
    and having each enclosure having shape_style entity_type_outline. It would be better if default was generated and
    if shape style were not generated for each individual enclosure. 
2. Why is there a css file and also shape definitions xml?
   I think the idea is that the css file is generated fom the shape definitions but this currently doesn't happen.
3. I want to keep the includes. At the moment in the examples in src_routes I have
```
      <include>
            <filename>../src_xtests/shared/text_style_definitions.xml</filename>
      </include>
      <include>
            <filename>../src_xtests/shared/shape_style_definitions.xml</filename>
      </include>
      <include>
            <filename>../src_xtests/shared/endline_style_definitions.xml</filename>
      </include>
```
whereas in flex diagram generated by er2flex I have
```
   <include>
      <filename>file:///C:/Users/John/Documents/Cloudwork/BuildArea/ERScript/scripts/../flexDiagramming/methods/era/xml/text_style_definitions.xml</filename>
   </include>
   <include>
      <filename>file:///C:/Users/John/Documents/Cloudwork/BuildArea/ERScript/scripts/../flexDiagramming/methods/era/xml/shape_style_definitions.xml</filename>
   </include>
   <include>
      <filename>file:///C:/Users/John/Documents/Cloudwork/BuildArea/ERScript/scripts/../flexDiagramming/methods/era/xml/endline_style_definitions.xml</filename>
   </include>
```
4. I am thinking that I need a new method attribute of the diagram as a whole.
5. Remove the above includes. 
6. Replace by initial pass of processing that generates the previous includes.
7. Will need to remodel the examples in flexDiagramming as being of method type test.
### Proposal
1. Can proceed in small steps each of which can be tested before the next step implemented.
#### Step One
1. Change the Flex meta model to have a 'method' attribute.
2. Change er2flex to generate the method attribute with a value of 'era'.
3. Test by rebuilding Brinton example and by visual inspection of diagram.
#### Step Two
1. Split method/era/flexdiagrammingsvg.css file into two files
eraStyles.css
flexAnimationStyles.css
2. Get rid off unused classes such as class outline.
2. Find a new home in source for flexAnimationStyles.css
3. Modify xslt/flex/diagram2.svg.xslt to generate use of these files in svg in place of flexdiagrammingsvg.css
   using the method attribute of the diagram to construct the method styles 'eraStyles.css'.
4. Test by rebuild Brinton example and viewing through http. Test that animation works.

#### Step Three
1. Create a method called 'test' alongside the era method.
2. In the 'test' method have testStyles.css as a cut down of flexAnimationStyles.css.
3. In the test method have the shape defintions, text style defintions and endline definitions from the example routes shared folder.
4. Change all examples. Remove all includes. Specify value 'test' for the method attribute. 
5. Test by rebuilding all examples.

#### Step Four
1. In each of the test and era methods create a single 'styles.xml' file which includes 
the three styles files.
2. Create an xslt that creates a css from 'styles.xml'.
3. Modify the build within each methods folder to use this xslt to generate the method css instead of copying from source.
4. Remove previous source of methods css files.
5. Test by building testStyles.css and eraStyles.css.
6. Test through http that flexDiagramming examples and also selected Brinton examples look and interact OK.

### Final Testing
Rebuild and inspect through http
 -- all flex diagramming examples.
 -- examplesSelected -- Brinton example, Chen example, Order Entry.
 -- all other flexDiagrams.

### Completion Date
Estimate two days work. Risk that could be longer.
